

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Resuming Apps &mdash; connectSDK  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FAQ" href="ios-faq.html" />
    <link rel="prev" title="Checking Capabilities" href="ios-checking-capabilities.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">DISCOVER</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../discover/overview.html">Connect SDK Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../discover/use-cases.html">Use Cases</a></li>
</ul>
<p class="caption"><span class="caption-text">FUNDAMENTALS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../fundamentals/supported-feature.html">Supported features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fundamentals/beam-icon.html">Beam Icon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fundamentals/sample-apps.html">Sample Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fundamentals/testing-debugging.html">Testing &amp; Debugging</a></li>
</ul>
<p class="caption"><span class="caption-text">SDK DOWNLOAD</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../download-connect-sdk.html">Download Connect SDK</a></li>
</ul>
<p class="caption"><span class="caption-text">GUIDE:: ANDROID</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide-and/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide-and/index.html#developer-guides">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide-and/index.html#api-references">API References</a></li>
</ul>
<p class="caption"><span class="caption-text">GUIDE:: CORDOVA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide-cor/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide-cor/index.html#developer-guides">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide-cor/index.html#api-references">API References</a></li>
</ul>
<p class="caption"><span class="caption-text">GUIDE:: IOS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html#developer-guides">Developer Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ios-beam-media.html">Beam Media</a></li>
<li class="toctree-l2"><a class="reference internal" href="ios-beam-web-apps.html">Beam Web Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="ios-launch-app.html">Launch App on TV</a></li>
<li class="toctree-l2"><a class="reference internal" href="ios-discovery-manager.html">Discovery Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="ios-checking-capabilities.html">Checking Capabilities</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Resuming Apps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#connectabledevice-id">ConnectableDevice ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launchsession">LaunchSession</a></li>
<li class="toctree-l3"><a class="reference internal" href="#webappsession">WebAppSession</a></li>
<li class="toctree-l3"><a class="reference internal" href="#resuming-most-recent-connection">Resuming most recent connection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#important-note-about-reconnecting">Important note about reconnecting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#save-device-id-to-disk">Save device ID to disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reconnect-to-device">Reconnect to device</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#resuming-a-web-app-session">Resuming a web app session</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#save-session-info-to-disk">Save session info to disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="#re-create-session-after-device-is-connected-ready">Re-create session after device is connected/ready</a></li>
<li class="toctree-l4"><a class="reference internal" href="#low-effort-re-connection-option">Low-effort re-connection option</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ios-faq.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#api-references">API References</a></li>
</ul>
<p class="caption"><span class="caption-text">GUIDE:: WEB APP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide-web/index.html">TV Web Apps</a></li>
</ul>
<p class="caption"><span class="caption-text">BLOG</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../blog/index.html">Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../blog/index.html#article">Article</a></li>
</ul>
<p class="caption"><span class="caption-text">ABOUT CONNECT SDK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../terms-and-conditions.html">Terms and Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../privacy-policy.html">Privacy Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">connectSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Getting Started</a> &raquo;</li>
        
      <li>Resuming Apps</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/guide-ios/ios-resuming-apps.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="resuming-apps">
<h1>Resuming Apps<a class="headerlink" href="#resuming-apps" title="Permalink to this headline">¶</a></h1>
<p>It may be necessary for your app to resume from a background or closed
state and re-establish connection with a previously connected device.
There are many ways in which Connect SDK provides information to allow
for this behavior.</p>
<div class="section" id="connectabledevice-id">
<h2>ConnectableDevice ID<a class="headerlink" href="#connectabledevice-id" title="Permalink to this headline">¶</a></h2>
<p>Each ConnectableDevice has a unique ID assigned to it upon creation.
When that device is connected to, the device store saves information
about each of the device’s services. The unique ID persists across app
launches by attributing service UUIDs to the unique device ID in the
device store.</p>
</div>
<div class="section" id="launchsession">
<h2>LaunchSession<a class="headerlink" href="#launchsession" title="Permalink to this headline">¶</a></h2>
<p>The ability to interact with an app requires some information to
persist, including a session ID. This session ID may be required to
close the app, as well as allow the app to accurately track certain
state information.</p>
</div>
<div class="section" id="webappsession">
<h2>WebAppSession<a class="headerlink" href="#webappsession" title="Permalink to this headline">¶</a></h2>
<p>The ability to communicate with a web app requires a LaunchSession
object and/or the web app id.</p>
</div>
<div class="section" id="resuming-most-recent-connection">
<h2>Resuming most recent connection<a class="headerlink" href="#resuming-most-recent-connection" title="Permalink to this headline">¶</a></h2>
<p>In order to save &amp; reconnect to a previously connected device, all you
need to keep track of is the device’s ID. Assuming you are using the
ConnectableDeviceStore included with Connect SDK, previously connected
devices will persist the same ID between app launches.</p>
<p>When your app restarts, you should immediately start discovery and
listen for device found events from DiscoveryManager. In these events,
you can check each device’s ID and call <code class="docutils literal notranslate"><span class="pre">connect</span></code> on the previously
connected device.</p>
<div class="section" id="important-note-about-reconnecting">
<h3>Important note about reconnecting<a class="headerlink" href="#important-note-about-reconnecting" title="Permalink to this headline">¶</a></h3>
<p>Just because your device has been discovered on the network doesn’t mean
that all of its services/capabilities are available. You will need to
set a CapabilityFilter on DiscoveryManager or manually check the
ConnectableDevice’s capabilities before you call <code class="docutils literal notranslate"><span class="pre">connect</span></code>.</p>
</div>
<div class="section" id="save-device-id-to-disk">
<h3>Save device ID to disk<a class="headerlink" href="#save-device-id-to-disk" title="Permalink to this headline">¶</a></h3>
<div class="highlight-obj-c notranslate"><div class="highlight"><pre><span></span><span class="n">ConnectableDevice</span> <span class="o">*</span><span class="n">device</span><span class="p">;</span> <span class="c1">// device you&#39;ve connected to</span>

<span class="p">[[</span><span class="bp">NSUserDefaults</span> <span class="n">standardUserDefaults</span><span class="p">]</span> <span class="nl">setObject</span><span class="p">:</span><span class="n">device</span><span class="p">.</span><span class="kt">id</span> <span class="nl">forKey</span><span class="p">:</span><span class="s">@&quot;recentDeviceId&quot;</span><span class="p">];</span>

<span class="c1">// save right away before entering background</span>
<span class="p">[</span><span class="bp">NSUserDefaults</span> <span class="n">standardUserDefaults</span><span class="p">]</span> <span class="n">synchronize</span><span class="p">];</span>
</pre></div>
</div>
</div>
<div class="section" id="reconnect-to-device">
<h3>Reconnect to device<a class="headerlink" href="#reconnect-to-device" title="Permalink to this headline">¶</a></h3>
<div class="highlight-obj-c notranslate"><div class="highlight"><pre><span></span><span class="n">ConnectableDevice</span> <span class="o">*</span><span class="n">mDevice</span><span class="p">;</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">mRecentDeviceId</span><span class="p">;</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">viewDidLoad</span> <span class="p">{</span>
    <span class="p">[</span><span class="nb">super</span> <span class="n">viewDidLoad</span><span class="p">];</span>

    <span class="n">mRecentDeviceId</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSUserDefaults</span> <span class="n">standardUserDefaults</span><span class="p">]</span> <span class="nl">objectForKey</span><span class="p">:</span><span class="s">@&quot;recentDeviceId&quot;</span><span class="p">];</span>

    <span class="p">[[</span><span class="n">DiscoveryManager</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="nl">setCapabilityFilters</span><span class="p">:</span><span class="n">myCapabilityFilters</span><span class="p">];</span>
    <span class="p">[[</span><span class="n">DiscoveryManager</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="nl">setDelegate</span><span class="p">:</span><span class="nb">self</span><span class="p">];</span>
    <span class="p">[[</span><span class="n">DiscoveryManager</span> <span class="n">sharedManager</span><span class="p">]</span> <span class="n">start</span><span class="p">];</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">discoveryManager:</span><span class="p">(</span><span class="n">DiscoveryManager</span> <span class="o">*</span><span class="p">)</span><span class="nv">manager</span> <span class="nf">didFindDevice:</span><span class="p">(</span><span class="n">ConnectableDevice</span> <span class="o">*</span><span class="p">)</span><span class="nv">device</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">mRecentDeviceId</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">mDevice</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">([</span><span class="n">device</span><span class="p">.</span><span class="kt">id</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="n">mRecentDeviceId</span><span class="p">])</span> <span class="p">{</span>
            <span class="n">mDevice</span> <span class="o">=</span> <span class="n">device</span><span class="p">;</span>
            <span class="p">[</span><span class="n">device</span> <span class="nl">setDelegate</span><span class="p">:</span><span class="nb">self</span><span class="p">];</span>
            <span class="p">[</span><span class="n">device</span> <span class="n">connect</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="resuming-a-web-app-session">
<h2>Resuming a web app session<a class="headerlink" href="#resuming-a-web-app-session" title="Permalink to this headline">¶</a></h2>
<p>Resuming a web app session is as simple as saving the WebAppSession’s
LaunchSession object before entering the background. It can even be
serialized into a JSON object for easy cross-platform storage.</p>
<div class="section" id="save-session-info-to-disk">
<h3>Save session info to disk<a class="headerlink" href="#save-session-info-to-disk" title="Permalink to this headline">¶</a></h3>
<div class="highlight-obj-c notranslate"><div class="highlight"><pre><span></span><span class="n">WebAppSession</span> <span class="o">*</span><span class="n">webAppSession</span><span class="p">;</span> <span class="c1">// retrieved from WebAppLauncher launch success block</span>

<span class="n">LaunchSession</span> <span class="o">*</span><span class="n">launchSession</span> <span class="o">=</span> <span class="n">webAppSession</span><span class="p">.</span><span class="n">launchSession</span><span class="p">;</span>
<span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">launchSessionInfo</span> <span class="o">=</span> <span class="p">[</span><span class="n">launchSession</span> <span class="n">toJSONObject</span><span class="p">];</span>

<span class="p">[[</span><span class="bp">NSUserDefaults</span> <span class="n">standardUserDefaults</span><span class="p">]</span> <span class="nl">setObject</span><span class="p">:</span><span class="n">launchSessionInfo</span> <span class="nl">forKey</span><span class="p">:</span><span class="s">@&quot;launchSession&quot;</span><span class="p">];</span>

<span class="c1">// save right away before entering background</span>
<span class="p">[</span><span class="bp">NSUserDefaults</span> <span class="n">standardUserDefaults</span><span class="p">]</span> <span class="n">synchronize</span><span class="p">];</span>
</pre></div>
</div>
</div>
<div class="section" id="re-create-session-after-device-is-connected-ready">
<h3>Re-create session after device is connected/ready<a class="headerlink" href="#re-create-session-after-device-is-connected-ready" title="Permalink to this headline">¶</a></h3>
<div class="highlight-obj-c notranslate"><div class="highlight"><pre><span></span><span class="n">ConnectableDevice</span> <span class="o">*</span><span class="n">device</span><span class="p">;</span> <span class="c1">// device that has been re-discovered &amp; re-connected</span>

<span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">launchSessionInfo</span> <span class="o">=</span> <span class="p">(</span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="p">)</span> <span class="p">[[</span><span class="bp">NSUserDefaults</span> <span class="n">standardUserDefaults</span><span class="p">]</span> <span class="nl">objectForKey</span><span class="p">:</span><span class="s">@&quot;launchSession&quot;</span><span class="p">];</span>
<span class="n">LaunchSession</span> <span class="o">*</span><span class="n">launchSession</span> <span class="o">=</span> <span class="p">[</span><span class="n">LaunchSession</span> <span class="nl">launchSessionFromJSONObject</span><span class="p">:</span><span class="n">launchSessionInfo</span><span class="p">];</span>

<span class="p">[</span><span class="n">device</span><span class="p">.</span><span class="n">webAppLauncher</span> <span class="nl">joinWebApp</span><span class="p">:</span><span class="n">launchSession</span>
                          <span class="nl">success</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">WebAppSession</span> <span class="o">*</span><span class="n">webAppSession</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
                          <span class="nl">failure</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSError</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span> <span class="p">];</span>
</pre></div>
</div>
</div>
<div class="section" id="low-effort-re-connection-option">
<h3>Low-effort re-connection option<a class="headerlink" href="#low-effort-re-connection-option" title="Permalink to this headline">¶</a></h3>
<p>Alternatively, you could re-join your web app with just the web app id.
This could have the side effect of generating new session information
for your user, which may not be desired.</p>
<div class="highlight-obj-c notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">device</span><span class="p">.</span><span class="n">webAppLauncher</span> <span class="nl">joinWebAppWithId</span><span class="p">:</span><span class="s">@&quot;your web app id&quot;</span>
                                <span class="nl">success</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">WebAppSession</span> <span class="o">*</span><span class="n">webAppSession</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
                                <span class="nl">failure</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSError</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span> <span class="p">];</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="ios-discover-connect.html"><span class="doc">Discover &amp; Connect to Device</span></a></p></li>
<li><p><a class="reference internal" href="ios-checking-capabilities.html"><span class="doc">Checking Capabilities</span></a></p></li>
<li><p><a class="reference internal" href="ios-beam-web-apps.html"><span class="doc">Beam Web Apps</span></a></p></li>
</ul>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ios-faq.html" class="btn btn-neutral float-right" title="FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ios-checking-capabilities.html" class="btn btn-neutral float-left" title="Checking Capabilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020 LG Silicon Valley Lab. All Rights Reserved. All trademarks and logos beling to their respective owners.

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>